<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.warehouse.management.warehouse.repository.WarehouseRepository">	
	
	<select id="getRegionOption" resultType="com.warehouse.management.store.dto.RegionOptionDto">
		SELECT 
			region_id regionId,
			region_name regionName
		FROM regions
		WHERE deleted_at IS NULL;
	</select>
	
	<select id="createAndSelectWarehouse" resultType="com.warehouse.management.store.dto.WarehouseDto">
		INSERT INTO warehouses(
		region_id, warehouse_name, created_at, updated_at)
		VALUES (#{regionId}, #{warehouseName}, NOW(), NOW());
		
		SELECT 
			warehouse_id warehouseId,
			region_id regionId,
			warehouse_name warehouseName,
			created_at createdAt,
			updated_at updatedAt
		FROM 
			warehouses
		WHERE created_at = NOW() AND deleted_at IS NULL AND region_id = #{regionId}
		LIMIT  1;
		
	</select>

	
</mapper>